maha<-function(y,x,alpha,beta,Sigma){    n = dim(y)[1]      d=matrix(0,n,1)  for (hh in 1:n){          mu<-alpha+beta*x[hh]    d[hh] = as.numeric(t(y[hh,]-mu)%*%solve(Sigma)%*%(y[hh,]-mu))  }    return(d)}dendist<-function(p,d,nu,pii){    g=length(pii)    soma=0  for (j in 1:g){        eta0 = nu[[j]][1]    omega=nu[[j]][2]    valorj=sqrt((omega+d)*omega)    num1=eta0-(p/2)    aux1=pii[j] *(d^((p/2)-1))*((omega+d)^((2*eta0-p)/4))*besselK(valorj,num1)    aux2= (2^(p/2))*gamma(p/2)*(omega^(eta0/2))*(sqrt(omega*omega))*(omega^(-p/4))    soma=soma+(aux1/aux2)  }    f1=log(soma)  return(f1)}envelopesempriricadist<-function(y,x,alpha,beta,Sigma,pii,eta1,eta2,eta3,omega1,omega2,omega3){    n=dim(y)[1]  p=dim(y)[2]  nu1 = c(eta1, omega1, omega1)  nu2 = c(eta2, omega2, omega2)    nu = list(nu1, nu2)  g=length(pii)  if(g==3){        nu3 = c(eta3, omega3, omega3)    nu = list(nu1, nu2, nu3)  }    d=maha(y,x,alpha,beta,Sigma)  u=dendist(p,d,nu,pii)  empiricau=ecdf(u)  plot(empiricau,u,xlab="Log density",ylab="ECDF",main="")    mu1 = rep(0,p)  mu2 = rep(0,p)  mu3 = rep(0,p)  shape1 = rep(0,p)  shape2 = rep(0,p)  shape3= rep(0,p)  mu = matrix(0, n, p)  for (i in 1:n) {    mu[i, ] = alpha + beta * x[i]  }    for(i in 1:500){    if(g==2){      arg1 = list(mu = mu1, Sigma = Sigma, shape = shape1, nu = nu1)      arg2 = list(mu = mu2, Sigma = Sigma, shape = shape2, nu = nu2)      y1 = rmmix(n = n, pii = pii, "GIG", list(arg1, arg2))}    if(g==3){      arg1 = list(mu = mu1, Sigma = Sigma, shape = shape1, nu = nu1)      arg2 = list(mu = mu2, Sigma = Sigma, shape = shape2, nu = nu2)      arg3 = list(mu = mu3, Sigma = Sigma, shape = shape3, nu = nu3)      y1 = rmmix(n = n, pii = pii, "GIG", list(arg1, arg2, arg3))    }        ynovo = y1 + mu        distnovo=maha(ynovo,x,alpha,beta,Sigma)    v=dendist(p,distnovo,nu,pii)    empiricav=ecdf(v)    par(new=TRUE)    plot(empiricav,v,xlab="",ylab="",main="",col="lightgray",axes=F)  }  par(new=TRUE)  plot(empiricau,u,xlab="",ylab="",main="",axes=F)  }